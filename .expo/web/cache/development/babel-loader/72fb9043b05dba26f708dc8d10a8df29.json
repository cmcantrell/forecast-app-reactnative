{"ast":null,"code":"\"use strict\";\n\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { percentageChangeOver72 } from \"./Helper\";\nexport var parseDWR = function parseDWR(data) {\n  try {\n    if (data.ResultList && data.ResultList.constructor.name == \"Array\") {\n      var timeSeries = data.ResultList;\n      var streamflowData = [{\n        _0hr: timeSeries[timeSeries.length - 1] || 0\n      }, {\n        _24hr: timeSeries[timeSeries.length - 2] || 0\n      }, {\n        _48hr: timeSeries[timeSeries.length - 3] || 0\n      }, {\n        _72hr: timeSeries[timeSeries.length - 4] || 0\n      }, {\n        _96hr: timeSeries[timeSeries.length - 5] || 0\n      }, {\n        _120hr: timeSeries[timeSeries.length - 6] || 0\n      }, {\n        _144hr: timeSeries[timeSeries.length - 7] || 0\n      }];\n      var mapPoints = [],\n          _72HrMapPoints = [];\n      var parsedStreamflowData = streamflowData.map(function (streamflow) {\n        var parsedData = {};\n\n        for (var _i = 0, _Object$entries = Object.entries(streamflow); _i < _Object$entries.length; _i++) {\n          var _ref = _Object$entries[_i];\n\n          var _ref2 = _slicedToArray(_ref, 2);\n\n          var key = _ref2[0];\n          var val = _ref2[1];\n\n          if (typeof val != \"object\") {\n            throw \"streamflowData[\" + key + \"] is not an object: \" + data.value.timeSeries[0].sourceInfo.siteName;\n          }\n\n          var measurementValue = null,\n              measurementType = null,\n              measurementTime = null;\n\n          if (val.parameter && val.parameter === \"STORAGE\") {\n            measurementValue = parseInt(val.measValue, 10) > 1 ? parseInt(val.measValue) : null, measurementType = (val.measUnit = \"ACFT\" ? \"acft\" : val.measUnit) || null, measurementTime = val.modified || null;\n          } else {\n            measurementValue = parseInt(val.value, 10) > 1 ? parseInt(val.value) : null, measurementType = (val.measUnit = \"cfs\" ? \"ft3/s\" : val.measUnit) || null, measurementTime = val.modified || null;\n          }\n\n          parsedData[key] = {\n            \"measurementTime\": measurementTime,\n            \"measurementValue\": measurementValue,\n            \"measurementType\": measurementType\n          };\n          mapPoints.push({\n            x: mapPoints.length,\n            y: measurementValue,\n            date: measurementTime\n          });\n\n          if (_72HrMapPoints.length < 4) {\n            _72HrMapPoints.push({\n              x: _72HrMapPoints.length,\n              y: measurementValue\n            });\n          }\n        }\n\n        return parsedData;\n      });\n      parsedStreamflowData.push({\n        \"mapPoints\": mapPoints\n      });\n      parsedStreamflowData.push({\n        \"_72HrPercentageChange\": percentageChangeOver72(_72HrMapPoints)\n      });\n      return parsedStreamflowData;\n    }\n  } catch (e) {\n    console.log(\"Exception @DWRHelper.parseDWR\", e);\n    return [];\n  }\n};","map":{"version":3,"sources":["/Users/clinton/Apps/fc-reactnative/testapp/lib/helper/DWRHelper.js"],"names":["percentageChangeOver72","parseDWR","data","ResultList","constructor","name","timeSeries","streamflowData","_0hr","length","_24hr","_48hr","_72hr","_96hr","_120hr","_144hr","mapPoints","_72HrMapPoints","parsedStreamflowData","map","streamflow","parsedData","Object","entries","key","val","value","sourceInfo","siteName","measurementValue","measurementType","measurementTime","parameter","parseInt","measValue","measUnit","modified","push","x","y","date","e","console","log"],"mappings":"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","sourcesContent":["\"use strict\";\n\nimport {percentageChangeOver72} from \"./Helper\";\n\nexport const parseDWR = (data) => {\n    // console.log(typeof data.ResultList, data.ResultList.constructor.name);\n    try {\n        if (data.ResultList && data.ResultList.constructor.name == \"Array\") {\n            const timeSeries = data.ResultList;\n            let streamflowData = [\n                { _0hr: timeSeries[timeSeries.length - 1] || 0 },\n                { _24hr: timeSeries[timeSeries.length - 2] || 0 },\n                { _48hr: timeSeries[timeSeries.length - 3] || 0 },\n                { _72hr: timeSeries[timeSeries.length - 4] || 0 },\n                { _96hr: timeSeries[timeSeries.length - 5] || 0 },\n                { _120hr: timeSeries[timeSeries.length - 6] || 0 },\n                { _144hr: timeSeries[timeSeries.length - 7] || 0 }\n            ];\n            let mapPoints = [],\n                _72HrMapPoints = [];\n            let parsedStreamflowData = streamflowData.map((streamflow) => {\n                let parsedData = {};\n                for (let [key, val] of Object.entries(streamflow)) {\n                    if (typeof val != \"object\") {\n                        throw `streamflowData[${key}] is not an object: ${data.value.timeSeries[0].sourceInfo.siteName}`;\n                    }\n                    // console.log(key, val);\n                    let measurementValue = null,\n                        measurementType = null,\n                        measurementTime = null;\n                    if(val.parameter && val.parameter === \"STORAGE\"){\n                        measurementValue = (parseInt(val.measValue, 10) > 1) ? parseInt(val.measValue) : null,\n                        measurementType = (val.measUnit = \"ACFT\" ? \"acft\" : val.measUnit) || null,\n                        measurementTime = val.modified || null;\n                    }else{\n                        measurementValue = (parseInt(val.value, 10) > 1) ? parseInt(val.value) : null,\n                        measurementType = (val.measUnit = \"cfs\" ? \"ft3/s\" : val.measUnit) || null,\n                        measurementTime = val.modified || null;\n                    }\n                    \n                    parsedData[key] = {\n                        \"measurementTime\": measurementTime,\n                        \"measurementValue\": measurementValue,\n                        \"measurementType\": measurementType\n                    };\n                    // console.log(parsedData[key]);\n                    /**\n                     * @mapPoints\n                     * build add map points for graph\n                     */\n                    mapPoints.push({ x: mapPoints.length, y: measurementValue, date: measurementTime });\n                    /**\n                     * @_72HrMapPoints\n                     * build out 72 hour map points to find rate change\n                     */\n                    if (_72HrMapPoints.length < 4) {\n                        _72HrMapPoints.push({ x: _72HrMapPoints.length, y: measurementValue });\n                    }\n                }\n                // console.log(parsedData);\n                return parsedData;\n            });\n            // add map points for graph\n            parsedStreamflowData.push({ \"mapPoints\": mapPoints });\n            // build out rate change from @_72HrMapPoints and add to return\n            parsedStreamflowData.push({ \"_72HrPercentageChange\": percentageChangeOver72(_72HrMapPoints) });\n            return parsedStreamflowData;\n        }\n    }catch (e) {\n        console.log(\"Exception @DWRHelper.parseDWR\", e);\n        return [];\n    }\n};\n"]},"metadata":{},"sourceType":"module"}